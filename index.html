<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAQÊÉÖÂ†±ÁÆ°ÁêÜ„ÉÑ„Éº„É´</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8fafc;
            color: #334155;
            overflow-x: hidden;
        }
        
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* „Çµ„Ç§„Éâ„Éê„Éº */
        .sidebar {
            width: 320px;
            background: white;
            border-right: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 1000;
        }
        
        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid #e2e8f0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .sidebar-header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .sidebar-header p {
            font-size: 0.875rem;
            opacity: 0.9;
        }
        
        .main-nav {
            padding: 16px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #64748b;
            font-weight: 500;
            font-size: 14px;
        }
        
        .nav-item:hover {
            background: #f1f5f9;
            color: #334155;
        }
        
        .nav-item.active {
            background: #e0e7ff;
            color: #4f46e5;
            border-right: 3px solid #4f46e5;
        }
        
        .nav-icon {
            margin-right: 12px;
            font-size: 16px;
        }
        
        .category-section {
            flex: 1;
            padding: 16px 0;
            overflow-y: auto;
        }
        
        .category-header {
            padding: 0 20px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .category-header h3 {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .add-category-btn {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 6px 8px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }
        
        .add-category-btn:hover {
            background: #4338ca;
            transform: scale(1.05);
        }
        
        .add-category-form {
            padding: 0 20px 16px;
            display: none;
        }
        
        .add-category-form.show {
            display: block;
        }
        
        .add-category-form input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .form-actions {
            display: flex;
            gap: 8px;
        }
        
        .form-actions button {
            flex: 1;
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .save-category-btn {
            background: #10b981;
            color: white;
        }
        
        .cancel-category-btn {
            background: #6b7280;
            color: white;
        }
        
        .category-list {
            padding: 0 8px;
        }
        
        .category-item {
            margin: 4px 0;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            group: 1;
        }
        
        .category-item:hover {
            background: #f1f5f9;
        }
        
        .category-item.active {
            background: #e0e7ff;
            color: #4f46e5;
        }
        
        .category-name {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .category-count {
            font-size: 12px;
            color: #6b7280;
        }
        
        .category-actions {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        
        .category-item:hover .category-actions {
            opacity: 1;
        }
        
        .category-actions button {
            background: rgba(255,255,255,0.9);
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            padding: 4px 6px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .category-actions .edit-btn {
            color: #059669;
        }
        
        .category-actions .delete-btn {
            color: #dc2626;
        }
        
        .category-actions button:hover {
            background: white;
            transform: scale(1.1);
        }
        
        .empty-categories {
            padding: 20px;
            text-align: center;
            color: #9ca3af;
            font-size: 14px;
        }
        
        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ */
        .main-content {
            flex: 1;
            margin-left: 320px;
            background: #f8fafc;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .content-header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 16px 32px;
            position: sticky;
            top: 0;
            z-index: 100;
            flex-shrink: 0;
            display: flex;
            align-items: center;
        }
        
        .breadcrumb {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px;
        }
        
        .breadcrumb-item {
            display: flex;
            align-items: center;
        }
        
        .breadcrumb-separator {
            margin: 0 8px;
            color: #d1d5db;
        }
        
        .page-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #111827;
        }
        
        .content-body {
            padding: 32px;
            flex: 1;
            width: 100%;
            max-width: none;
        }
        
        /* „ÉÑ„Éº„É´„Éê„Éº */
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .toolbar-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px 16px;
            flex: 1;
            min-width: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .toolbar-card h4 {
            font-size: 13px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .toolbar-card p {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 12px;
            line-height: 1.4;
        }
        
        .compact-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            white-space: nowrap;
            width: 100%;
            min-height: 38px;
        }
        
        .compact-btn-primary {
            background: #4f46e5;
            color: white;
        }
        
        .compact-btn-primary:hover {
            background: #4338ca;
        }
        
        .compact-btn-success {
            background: #10b981;
            color: white;
        }
        
        .compact-btn-success:hover {
            background: #059669;
        }
        
        .file-upload-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }
        
        .file-upload-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }
        
        .welcome-screen {
            text-align: center;
            padding: 80px 20px;
        }
        
        .welcome-icon {
            font-size: 4rem;
            color: #d1d5db;
            margin-bottom: 24px;
        }
        
        .welcome-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 12px;
        }
        
        .welcome-text {
            color: #6b7280;
            font-size: 1rem;
            margin-bottom: 32px;
        }
        
        .welcome-action {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .welcome-action:hover {
            background: #4338ca;
            transform: translateY(-1px);
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            margin-bottom: 24px;
            overflow: hidden;
            width: 100%;
        }
        
        .card-header {
            padding: 20px 24px;
            border-bottom: 1px solid #f3f4f6;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #111827;
        }
        
        .card-body {
            padding: 24px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 6px;
        }
        
        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: white;
        }
        
        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }
        
        .btn-primary {
            background: #4f46e5;
            color: white;
        }
        
        .btn-primary:hover {
            background: #4338ca;
            transform: translateY(-1px);
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .record-item {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.2s ease;
        }
        
        .record-item:hover {
            border-color: #d1d5db;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .record-field {
            margin-bottom: 12px;
        }
        
        .record-field:last-child {
            margin-bottom: 0;
        }
        
        .record-label {
            font-size: 12px;
            font-weight: 500;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 4px;
        }
        
        .record-value {
            color: #374151;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .record-actions {
            margin-top: 16px;
            display: flex;
            gap: 8px;
        }
        
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .badge-primary {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .upload-status {
            margin-top: 16px;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .upload-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }
        
        .upload-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 32px;
        }
        
        .loading.show {
            display: block;
        }
        
        .spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .empty-state {
            text-align: center;
            padding: 48px 20px;
            color: #9ca3af;
        }
        
        .empty-icon {
            font-size: 3rem;
            margin-bottom: 16px;
        }
        
        .empty-title {
            font-size: 1.125rem;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .empty-text {
            font-size: 14px;
        }
        
        /* Ë≥™Âïè‰∏ÄË¶ß„Éú„Çø„É≥ */
        .question-list-btn {
            background: #f59e0b;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 16px;
        }
        
        .question-list-btn:hover {
            background: #d97706;
            transform: translateY(-1px);
        }
        
        /* „É¢„Éº„ÉÄ„É´ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        }
        
        .modal-overlay.show {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            width: 100%;
            max-width: 800px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }
        
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #111827;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: #f3f4f6;
            color: #374151;
        }
        
        .modal-body {
            padding: 0;
            overflow-y: auto;
            flex: 1;
        }
        
        .question-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .question-item {
            border-bottom: 1px solid #f3f4f6;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .question-item:hover {
            background: #f8fafc;
        }
        
        .question-item:last-child {
            border-bottom: none;
        }
        
        .question-summary {
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .question-text {
            font-weight: 500;
            color: #374151;
            flex: 1;
        }
        
        .question-meta {
            font-size: 12px;
            color: #6b7280;
            margin-left: 12px;
        }
        
        .question-details {
            padding: 0 24px 16px;
            border-top: 1px solid #f3f4f6;
            background: #fafbfc;
            display: none;
        }
        
        .question-details.show {
            display: block;
        }
        
        .question-actions {
            margin-top: 12px;
            display: flex;
            gap: 8px;
            padding-top: 12px;
            border-top: 1px solid #e5e7eb;
        }
        
        .modal-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .modal-btn-edit {
            background: #059669;
            color: white;
        }
        
        .modal-btn-edit:hover {
            background: #047857;
        }
        
        .modal-btn-delete {
            background: #dc2626;
            color: white;
        }
        
        .modal-btn-delete:hover {
            background: #b91c1c;
        }
        
        .edit-form {
            margin-top: 12px;
            padding: 16px;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            display: none;
        }
        
        .edit-form.show {
            display: block;
        }
        
        .edit-form-group {
            margin-bottom: 12px;
        }
        
        .edit-form-label {
            display: block;
            font-size: 12px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 4px;
        }
        
        .edit-form-input,
        .edit-form-textarea {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 13px;
            background: white;
        }
        
        .edit-form-textarea {
            resize: vertical;
            min-height: 60px;
        }
        
        .edit-form-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }
        
        .detail-section {
            margin: 12px 0;
        }
        
        .detail-label {
            font-size: 12px;
            font-weight: 500;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 4px;
        }
        
        .detail-value {
            color: #374151;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .detail-value a {
            color: #4f46e5;
            text-decoration: none;
        }
        
        .detail-value a:hover {
            text-decoration: underline;
        }
        
        .modal-empty {
            padding: 48px 24px;
            text-align: center;
            color: #9ca3af;
        }
        
        .modal-empty-icon {
            font-size: 3rem;
            margin-bottom: 16px;
        }
        
        /* Ë≥™Âïè„É™„Çπ„ÉàÁÆ°ÁêÜ */
        .question-list-container {
            margin-bottom: 20px;
        }
        
        .question-input-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .question-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: white;
        }
        
        .question-input:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.1);
        }
        
        .question-input.main-question {
            font-weight: 500;
            border-color: #4f46e5;
            background: #fafbff;
        }
        
        .question-label {
            font-size: 12px;
            font-weight: 500;
            color: #6b7280;
            width: 80px;
            flex-shrink: 0;
        }
        
        .question-label.main {
            color: #4f46e5;
        }
        
        .remove-question-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 6px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .remove-question-btn:hover {
            background: #dc2626;
        }
        
        .add-question-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .add-question-btn:hover {
            background: #059669;
        }
        
        .question-count-info {
            font-size: 11px;
            color: #6b7280;
            margin-top: 4px;
            font-style: italic;
        }
        
        .vector-info {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .vector-info h3 {
            color: #0c4a6e;
            margin-bottom: 8px;
            font-size: 1rem;
        }
        
        .vector-info p {
            color: #0369a1;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 32px;
            text-align: center;
            transition: all 0.2s ease;
            background: #fafbfc;
        }
        
        .upload-area:hover {
            border-color: #4f46e5;
            background: #f8faff;
        }
        
        .upload-icon {
            font-size: 2.5rem;
            color: #9ca3af;
            margin-bottom: 16px;
        }
        
        .upload-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }
        
        .upload-text {
            color: #6b7280;
            margin-bottom: 20px;
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #374151;
            cursor: pointer;
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
        @media (max-width: 1024px) {
            .content-body {
                padding: 20px;
            }
            
            .sidebar {
                width: 280px;
            }
            
            .main-content {
                margin-left: 280px;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                width: 100%;
            }
            
            .content-body {
                padding: 16px;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .content-header {
                padding: 12px 20px;
            }
            
            .toolbar {
                flex-direction: column;
                gap: 16px;
            }
            
            .toolbar-card {
                min-width: 0;
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .content-body {
                padding: 12px;
            }
            
            .card-body {
                padding: 16px;
            }
            
            .toolbar {
                padding: 12px;
            }
            
            .compact-btn {
                padding: 6px 12px;
                font-size: 12px;
                min-height: 36px;
            }
            
            .question-list-btn {
                width: 100%;
                justify-content: center;
                margin-bottom: 20px;
            }
            
            .modal-content {
                margin: 10px;
                max-height: 90vh;
            }
            
            .modal-header {
                padding: 16px 20px;
            }
            
            .question-summary {
                padding: 12px 16px;
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .question-meta {
                margin-left: 0;
            }
            
            .question-details {
                padding: 0 16px 12px;
            }
            
            .question-actions {
                flex-direction: column;
                gap: 8px;
            }
            
            .modal-btn {
                width: 100%;
                padding: 8px 12px;
            }
        }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1>FAQ Manager</h1>
                <p>Knowledge Base System</p>
            </div>
            
            <div class="main-nav">
                <div class="nav-item active" data-tab="faq">
                    <span class="nav-icon">üìù</span>
                    FAQÁÆ°ÁêÜ
                </div>
                <div class="nav-item" data-tab="vector">
                    <span class="nav-icon">ü§ñ</span>
                    „Éô„ÇØ„Éà„É´ÂåñÂá¶ÁêÜ
                </div>
            </div>
            
            <div class="category-section">
                <div class="category-header">
                    <h3>„Ç´„ÉÜ„Ç¥„É™</h3>
                    <button class="add-category-btn" onclick="toggleAddCategoryForm()">+ ËøΩÂä†</button>
                </div>
                
                <div class="add-category-form" id="add-category-form">
                    <input type="text" id="new-category-name" placeholder="„Ç´„ÉÜ„Ç¥„É™Âêç„ÇíÂÖ•Âäõ">
                    <div class="form-actions">
                        <button class="save-category-btn" onclick="addCategory()">ËøΩÂä†</button>
                        <button class="cancel-category-btn" onclick="toggleAddCategoryForm()">„Ç≠„É£„É≥„Çª„É´</button>
                    </div>
                </div>
                
                <div class="category-list" id="category-list">
                    <div class="empty-categories">
                        „Ç´„ÉÜ„Ç¥„É™„Åå„ÅÇ„Çä„Åæ„Åõ„Çì<br>
                        ‰∏ä„ÅÆ„Äå+ ËøΩÂä†„Äç„Åã„Çâ‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                    </div>
                </div>
            </div>
        </div>
        
        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
        <div class="main-content">
            <div class="content-header">
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
            </div>
            
            <div class="content-body">
                <!-- FAQÁÆ°ÁêÜ„Çø„Éñ -->
                <div id="faq-tab" class="tab-content">
                    <!-- „ÉÑ„Éº„É´„Éê„Éº -->
                    <div class="toolbar">
                        <div class="toolbar-card">
                            <h4>üìÅ „Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø</h4>
                            <p>CSV„Åæ„Åü„ÅØExcel„Éï„Ç°„Ç§„É´„Åã„Çâ„Éá„Éº„Çø„ÇíÂèñ„ÇäËæº„Åø</p>
                            <div class="button-container">
                                <div class="file-upload-wrapper">
                                    <input type="file" id="csv-file" accept=".csv,.xlsx,.xls" onchange="handleFileUpload(event)">
                                    <button class="compact-btn compact-btn-primary" onclick="document.getElementById('csv-file').click()">
                                        „Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="toolbar-card">
                            <h4>üì• „Éá„Éº„ÇøÂá∫Âäõ</h4>
                            <p>ÂÖ®„Å¶„ÅÆFAQ„Éá„Éº„Çø„ÇíCSVÂΩ¢Âºè„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</p>
                            <div class="button-container">
                                <button class="compact-btn compact-btn-success" onclick="downloadCSV()">
                                    CSV„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- „Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÁµêÊûúË°®Á§∫„Ç®„É™„Ç¢ -->
                    <div id="upload-status-area"></div>
                    
                    <!-- „Ç¶„Çß„É´„Ç´„É†ÁîªÈù¢ -->
                    <div id="welcome-screen" class="welcome-screen">
                        <div class="welcome-icon">üìã</div>
                        <h2 class="welcome-title">FAQ„Éá„Éº„Çø„ÇíÁÆ°ÁêÜ„Åó„Åæ„Åó„Çá„ÅÜ</h2>
                        <p class="welcome-text">Â∑¶„ÅÆ„Çµ„Ç§„Éâ„Éê„Éº„Åã„Çâ„Ç´„ÉÜ„Ç¥„É™„Çí‰ΩúÊàê„Åó„Å¶„ÄÅFAQÈ†ÖÁõÆ„ÇíËøΩÂä†„Åß„Åç„Åæ„Åô</p>
                        <button class="welcome-action" onclick="toggleAddCategoryForm()">
                            ÊúÄÂàù„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Çí‰ΩúÊàê
                        </button>
                    </div>
                    
                    <!-- FAQÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
                    <div id="faq-input-section" class="card" style="display: none;">
                        <div class="card-header">
                            <h3 class="card-title" id="faq-form-title">Êñ∞„Åó„ÅÑFAQ„ÇíËøΩÂä†</h3>
                        </div>
                        <div class="card-body">
                            <button class="question-list-btn" onclick="showQuestionList()">
                                üìã Êó¢Â≠ò„ÅÆË≥™Âïè‰∏ÄË¶ß„ÇíÁ¢∫Ë™ç
                            </button>
                            <div class="form-group">
                                <label class="form-label">Ë≥™Âïè„É™„Çπ„Éà</label>
                                <div class="question-list-container" id="question-list-container">
                                    <div class="question-input-group">
                                        <span class="question-label main">„É°„Ç§„É≥</span>
                                        <input type="text" class="question-input main-question" id="main-question" placeholder="„É°„Ç§„É≥„ÅÆË≥™Âïè„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ" required>
                                    </div>
                                    <div class="question-input-group">
                                        <span class="question-label">È°û‰ºº1</span>
                                        <input type="text" class="question-input" placeholder="È°û‰ººË≥™Âïè„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà‰ªªÊÑèÔºâ">
                                        <button type="button" class="remove-question-btn" onclick="removeQuestionInput(this)" title="ÂâäÈô§">√ó</button>
                                    </div>
                                </div>
                                <button type="button" class="add-question-btn" onclick="addQuestionInput()">
                                    + È°û‰ººË≥™Âïè„ÇíËøΩÂä†
                                </button>
                                <div class="question-count-info">
                                    üí° È°û‰ººË≥™Âïè„ÇíËøΩÂä†„Åô„Çã„Å®Ê§úÁ¥¢Á≤æÂ∫¶„ÅåÂêë‰∏ä„Åó„Åæ„Åô
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ÂõûÁ≠î</label>
                                <textarea id="answer" class="form-textarea" placeholder="ÂõûÁ≠î„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Èñ¢ÈÄ£„É™„É≥„ÇØÔºà‰ªªÊÑèÔºâ</label>
                                <input type="url" id="link" class="form-input" placeholder="https://example.com">
                            </div>
                            <button class="btn btn-primary" onclick="addRecord()">
                                FAQÈ†ÖÁõÆ„ÇíËøΩÂä†
                            </button>
                        </div>
                    </div>
                    
                    <!-- FAQ‰∏ÄË¶ß -->
                    <div id="records-section" class="card" style="display: none;">
                        <div class="card-header">
                            <h3 class="card-title">
                                <span id="current-category-display">FAQ‰∏ÄË¶ß</span>
                                <span class="badge badge-primary" id="record-count">0‰ª∂</span>
                            </h3>
                        </div>
                        <div class="card-body">
                            <div id="records-list">
                                <div class="empty-state">
                                    <div class="empty-icon">üìù</div>
                                    <div class="empty-title">FAQ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                                    <div class="empty-text">‰∏ä„ÅÆ„Éï„Ç©„Éº„É†„Åã„ÇâÊúÄÂàù„ÅÆFAQÈ†ÖÁõÆ„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- „Éô„ÇØ„Éà„É´ÂåñÂá¶ÁêÜ„Çø„Éñ -->
                <div id="vector-tab" class="tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">„Éô„ÇØ„Éà„É´ÂåñÂá¶ÁêÜ„Å´„Å§„ÅÑ„Å¶</h3>
                        </div>
                        <div class="card-body">
                            <div class="vector-info">
                                <h3>ü§ñ AIÊ§úÁ¥¢Áî®„Éá„Éº„ÇøÂ§âÊèõ</h3>
                                <p>FAQÁÆ°ÁêÜ„Åß‰ΩúÊàê„Åó„ÅüCSV„Éï„Ç°„Ç§„É´„ÇíAIÊ§úÁ¥¢„Å´ÈÅ©„Åó„ÅüÂΩ¢Âºè„Å´Â§âÊèõ„Åó„Åæ„Åô„ÄÇÂá¶ÁêÜ„ÅåÂÆå‰∫Ü„Åô„Çã„Å®„ÄÅJSONL„Éï„Ç°„Ç§„É´„Å®BIN„Éï„Ç°„Ç§„É´„ÅåGoogle Cloud Storage„Å´„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åï„Çå„Åæ„Åô„ÄÇ</p>
                            </div>
                            
                            <div class="upload-area">
                                <div class="upload-icon">üöÄ</div>
                                <h3 class="upload-title">CSV„Éï„Ç°„Ç§„É´„Çí„Éô„ÇØ„Éà„É´Âåñ</h3>
                                <p class="upload-text">FAQÁÆ°ÁêÜ„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„ÅüCSV„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                                <input type="file" id="vector-csv-file" accept=".csv" style="display: none;" onchange="handleVectorFileUpload(event)">
                                <button class="btn btn-primary" onclick="document.getElementById('vector-csv-file').click()">
                                    CSV„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû
                                </button>
                            </div>
                            
                            <div id="vector-file-info" style="display: none; margin-top: 20px;">
                                <div class="upload-status upload-success">
                                    <strong>ÈÅ∏Êäû„Åï„Çå„Åü„Éï„Ç°„Ç§„É´:</strong> <span id="vector-file-name"></span>
                                </div>
                                <button class="btn btn-primary" onclick="processVectorization()" style="margin-top: 12px;">
                                    üöÄ „Éô„ÇØ„Éà„É´ÂåñÂá¶ÁêÜ„ÇíÈñãÂßã
                                </button>
                            </div>
                            
                            <div class="loading" id="vector-loading">
                                <div class="spinner"></div>
                                <p><strong>„Éô„ÇØ„Éà„É´ÂåñÂá¶ÁêÜ‰∏≠...</strong></p>
                                <p>Êï∞ÂàÜ„Åã„Åã„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ„Åó„Å∞„Çâ„Åè„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                            </div>
                            
                            <div class="upload-status upload-success" id="vector-success" style="display: none; margin-top: 20px;">
                                <strong>‚úÖ Âá¶ÁêÜ„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ</strong>
                                <p>JSONL„Éï„Ç°„Ç§„É´„Å®BIN„Éï„Ç°„Ç§„É´„ÅåGoogle Cloud Storage„Å´„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åï„Çå„Åæ„Åó„Åü„ÄÇ</p>
                            </div>
                            
                            <div class="upload-status upload-error" id="vector-error" style="display: none; margin-top: 20px;">
                                <strong>‚ùå „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü</strong>
                                <p id="vector-error-message"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ë≥™Âïè‰∏ÄË¶ß„É¢„Éº„ÉÄ„É´ -->
    <div class="modal-overlay" id="question-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-category-title">Ë≥™Âïè‰∏ÄË¶ß</h3>
                <button class="modal-close" onclick="hideQuestionList()">√ó</button>
            </div>
            <div class="modal-body">
                <ul class="question-list" id="modal-question-list">
                    <!-- Ë≥™Âïè‰∏ÄË¶ß„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                </ul>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // APIË®≠ÂÆö
        const PROCESS_API_URL = 'https://demo-webchatbot-201858952361.us-central1.run.app/api/process';
        
        let categories = {};
        let currentCategory = null;
        let currentTab = 'faq';
        let faqData = {};
        let editingId = null;
        let vectorCsvBlob = null;

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            loadCategories();
            updateCategoryDisplay();
            updateUIVisibility();
            initNavigation();
        });

        // „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ÂàùÊúüÂåñ
        function initNavigation() {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const tab = this.dataset.tab;
                    switchTab(tab);
                });
            });
        }

        // „Çø„ÉñÂàá„ÇäÊõø„Åà
        function switchTab(tab) {
            currentTab = tab;
            
            // „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥Êõ¥Êñ∞
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
            
            // „Ç≥„É≥„ÉÜ„É≥„ÉÑÊõ¥Êñ∞
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });
            document.getElementById(`${tab}-tab`).style.display = 'block';
            
            // „Éò„ÉÉ„ÉÄ„ÉºÊõ¥Êñ∞
            const titles = {
                'faq': 'FAQÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†',
                'vector': '„Éô„ÇØ„Éà„É´ÂåñÂá¶ÁêÜ'
            };
            // „Éò„ÉÉ„ÉÄ„Éº„Çø„Ç§„Éà„É´„ÅØÂâäÈô§„Åï„Çå„Åü„Åü„ÇÅ„ÄÅ„Ç≥„É°„É≥„Éà„Ç¢„Ç¶„Éà
            // document.getElementById('page-title').textContent = titles[tab];
            // document.getElementById('breadcrumb-current').textContent = titles[tab];
        }

        // „É¢„Éê„Ç§„É´„É°„Éã„É•„Éº
        function toggleMobileMenu() {
            document.getElementById('sidebar').classList.toggle('mobile-open');
        }

        // „Ç´„ÉÜ„Ç¥„É™ÁÆ°ÁêÜ
        function loadCategories() {
            const saved = localStorage.getItem('faq_categories');
            if (saved) {
                categories = JSON.parse(saved);
            }
            
            const savedData = localStorage.getItem('faq_data');
            if (savedData) {
                faqData = JSON.parse(savedData);
            }
        }

        function saveCategories() {
            localStorage.setItem('faq_categories', JSON.stringify(categories));
            localStorage.setItem('faq_data', JSON.stringify(faqData));
        }

        function toggleAddCategoryForm() {
            const form = document.getElementById('add-category-form');
            const isVisible = form.classList.contains('show');
            
            if (isVisible) {
                form.classList.remove('show');
                document.getElementById('new-category-name').value = '';
            } else {
                form.classList.add('show');
                setTimeout(() => {
                    document.getElementById('new-category-name').focus();
                }, 100);
            }
        }

        function addCategory() {
            const input = document.getElementById('new-category-name');
            const name = input.value.trim();
            
            if (!name) {
                alert('„Ç´„ÉÜ„Ç¥„É™Âêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            // ÈáçË§á„ÉÅ„Çß„ÉÉ„ÇØ
            const categoryKey = name.toLowerCase().replace(/\s+/g, '_');
            if (categories[categoryKey]) {
                alert('Âêå„ÅòÂêçÂâç„ÅÆ„Ç´„ÉÜ„Ç¥„É™„ÅåÊó¢„Å´Â≠òÂú®„Åó„Åæ„Åô');
                return;
            }
            
            categories[categoryKey] = name;
            faqData[categoryKey] = [];
            
            input.value = '';
            toggleAddCategoryForm();
            
            // Êñ∞„Åó„Åè‰ΩúÊàê„Åó„Åü„Ç´„ÉÜ„Ç¥„É™„ÇíËá™ÂãïÈÅ∏Êäû
            currentCategory = categoryKey;
            
            saveCategories();
            updateCategoryDisplay();
            updateUIVisibility();
            displayRecords();
        }

        function deleteCategory(categoryKey) {
            const categoryName = categories[categoryKey];
            const count = faqData[categoryKey] ? faqData[categoryKey].length : 0;
            
            if (count > 0) {
                if (!confirm(`„Äå${categoryName}„Äç„Å´„ÅØ${count}‰ª∂„ÅÆ„Éá„Éº„Çø„ÅåÂê´„Åæ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü`)) {
                    return;
                }
            } else {
                if (!confirm(`„Äå${categoryName}„Äç„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü`)) {
                    return;
                }
            }
            
            delete categories[categoryKey];
            delete faqData[categoryKey];
            
            if (currentCategory === categoryKey) {
                currentCategory = null;
            }
            
            saveCategories();
            updateCategoryDisplay();
            updateUIVisibility();
            displayRecords();
        }

        function editCategoryName(categoryKey) {
            const currentName = categories[categoryKey];
            const newName = prompt('Êñ∞„Åó„ÅÑ„Ç´„ÉÜ„Ç¥„É™Âêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:', currentName);
            
            if (!newName || newName.trim() === '') {
                return;
            }
            
            const trimmedName = newName.trim();
            if (trimmedName === currentName) {
                return;
            }
            
            // ÈáçË§á„ÉÅ„Çß„ÉÉ„ÇØÔºà‰ªñ„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Å®„ÅÆÈáçË§áÔºâ
            const newKey = trimmedName.toLowerCase().replace(/\s+/g, '_');
            if (newKey !== categoryKey && categories[newKey]) {
                alert('Âêå„ÅòÂêçÂâç„ÅÆ„Ç´„ÉÜ„Ç¥„É™„ÅåÊó¢„Å´Â≠òÂú®„Åó„Åæ„Åô');
                return;
            }
            
            // „Ç´„ÉÜ„Ç¥„É™Âêç„ÇíÊõ¥Êñ∞
            categories[categoryKey] = trimmedName;
            
            // „Éá„Éº„ÇøÂÜÖ„ÅÆ„Ç´„ÉÜ„Ç¥„É™Âêç„ÇÇÊõ¥Êñ∞
            if (faqData[categoryKey]) {
                faqData[categoryKey].forEach(record => {
                    record.category = trimmedName;
                });
            }
            
            saveCategories();
            updateCategoryDisplay();
        }

        function selectCategory(categoryKey) {
            currentCategory = categoryKey;
            updateCategoryDisplay();
            updateUIVisibility();
            displayRecords();
        }

        function updateCategoryDisplay() {
            const categoryList = document.getElementById('category-list');
            const categoryKeys = Object.keys(categories);
            
            if (categoryKeys.length === 0) {
                categoryList.innerHTML = `
                    <div class="empty-categories">
                        „Ç´„ÉÜ„Ç¥„É™„Åå„ÅÇ„Çä„Åæ„Åõ„Çì<br>
                        ‰∏ä„ÅÆ„Äå+ ËøΩÂä†„Äç„Åã„Çâ‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                    </div>
                `;
                return;
            }
            
            categoryList.innerHTML = categoryKeys.map(key => {
                const name = categories[key];
                const count = faqData[key] ? faqData[key].length : 0;
                const isActive = currentCategory === key;
                
                return `
                    <div class="category-item ${isActive ? 'active' : ''}" onclick="selectCategory('${key}')">
                        <div class="category-name">${name}</div>
                        <div class="category-count">${count}‰ª∂„ÅÆ„Éá„Éº„Çø</div>
                        <div class="category-actions">
                            <button class="edit-btn" onclick="event.stopPropagation(); editCategoryName('${key}')" title="Á∑®ÈõÜ">‚úèÔ∏è</button>
                            <button class="delete-btn" onclick="event.stopPropagation(); deleteCategory('${key}')" title="ÂâäÈô§">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateUIVisibility() {
            const hasCategories = Object.keys(categories).length > 0;
            const hasSelectedCategory = currentCategory !== null;
            
            // „Ç¶„Çß„É´„Ç´„É†ÁîªÈù¢„ÅÆË°®Á§∫Âà∂Âæ°
            document.getElementById('welcome-screen').style.display = hasSelectedCategory ? 'none' : 'block';
            
            // „Éï„Ç©„Éº„É†„Å®„É¨„Ç≥„Éº„Éâ‰∏ÄË¶ß„ÅÆË°®Á§∫Âà∂Âæ°
            document.getElementById('faq-input-section').style.display = hasSelectedCategory ? 'block' : 'none';
            document.getElementById('records-section').style.display = hasSelectedCategory ? 'block' : 'none';
            
            if (hasSelectedCategory) {
                // „Ç´„ÉÜ„Ç¥„É™Âêç„ÇíË°®Á§∫ÈÉ®ÂàÜ„Å´ÂèçÊò†
                const categoryName = categories[currentCategory];
                document.getElementById('current-category-display').textContent = categoryName;
                document.getElementById('faq-form-title').textContent = `„Äê${categoryName}„Äë„ÅÆÊñ∞„Åó„ÅÑFAQ„ÇíËøΩÂä†`;
            }
        }

        // „É¨„Ç≥„Éº„ÉâÁÆ°ÁêÜ
        function addRecord() {
            if (!currentCategory) {
                alert('„Ç´„ÉÜ„Ç¥„É™„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            // Ë≥™Âïè„É™„Çπ„Éà„ÇíÂèñÂæó
            const questions = getQuestionList();
            const answer = document.getElementById('answer').value.trim();
            const link = document.getElementById('link').value.trim();
            
            if (questions.length === 0 || !questions[0]) {
                alert('„É°„Ç§„É≥„ÅÆË≥™Âïè„ÅØÂøÖÈ†à„Åß„Åô');
                return;
            }
            
            if (!answer) {
                alert('ÂõûÁ≠î„ÅØÂøÖÈ†à„Åß„Åô');
                return;
            }
            
            const record = {
                id: Date.now(),
                category: categories[currentCategory],
                questions: questions, // Ë≥™Âïè„É™„Çπ„Éà„Å®„Åó„Å¶‰øùÂ≠ò
                mainQuestion: questions[0], // Ë°®Á§∫Áî®„ÅÆ„É°„Ç§„É≥Ë≥™Âïè
                answer: answer,
                link: link,
                createdAt: new Date().toLocaleString('ja-JP')
            };
            
            if (!faqData[currentCategory]) {
                faqData[currentCategory] = [];
            }
            
            faqData[currentCategory].push(record);
            saveCategories();
            displayRecords();
            updateCategoryDisplay();
            clearForm();
        }

        function getQuestionList() {
            const questions = [];
            const questionInputs = document.querySelectorAll('#question-list-container .question-input');
            
            questionInputs.forEach(input => {
                const value = input.value.trim();
                if (value) {
                    questions.push(value);
                }
            });
            
            return questions;
        }

        function addQuestionInput() {
            const container = document.getElementById('question-list-container');
            const questionCount = container.querySelectorAll('.question-input-group').length;
            
            const newInputGroup = document.createElement('div');
            newInputGroup.className = 'question-input-group';
            newInputGroup.innerHTML = `
                <span class="question-label">È°û‰ºº${questionCount}</span>
                <input type="text" class="question-input" placeholder="È°û‰ººË≥™Âïè„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà‰ªªÊÑèÔºâ">
                <button type="button" class="remove-question-btn" onclick="removeQuestionInput(this)" title="ÂâäÈô§">√ó</button>
            `;
            
            container.appendChild(newInputGroup);
        }

        function removeQuestionInput(button) {
            const inputGroup = button.parentElement;
            const container = document.getElementById('question-list-container');
            
            // „É°„Ç§„É≥Ë≥™Âïè‰ª•Â§ñ„ÅØÂâäÈô§ÂèØËÉΩ
            if (!inputGroup.querySelector('.main-question')) {
                container.removeChild(inputGroup);
                updateQuestionLabels();
            }
        }

        function updateQuestionLabels() {
            const container = document.getElementById('question-list-container');
            const inputGroups = container.querySelectorAll('.question-input-group');
            
            inputGroups.forEach((group, index) => {
                const label = group.querySelector('.question-label');
                if (index === 0) {
                    label.textContent = '„É°„Ç§„É≥';
                    label.className = 'question-label main';
                } else {
                    label.textContent = `È°û‰ºº${index}`;
                    label.className = 'question-label';
                }
            });
        }

        function clearForm() {
            // Ë≥™ÂïèÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢Ôºà„É°„Ç§„É≥Ë≥™Âïè‰ª•Â§ñ„ÇíÂâäÈô§Ôºâ
            const container = document.getElementById('question-list-container');
            const inputGroups = container.querySelectorAll('.question-input-group');
            
            // „É°„Ç§„É≥Ë≥™Âïè„Çí„ÇØ„É™„Ç¢
            document.getElementById('main-question').value = '';
            
            // È°û‰ººË≥™Âïè„ÅÆÂÖ•Âäõ„Ç∞„É´„Éº„Éó„ÇíÂâäÈô§ÔºàÊúÄÂàù„ÅÆ1„Å§„ÅØÊÆã„ÅôÔºâ
            for (let i = inputGroups.length - 1; i > 1; i--) {
                container.removeChild(inputGroups[i]);
            }
            
            // ÊÆã„Å£„ÅüÈ°û‰ººË≥™ÂïèÂÖ•Âäõ„Çí„ÇØ„É™„Ç¢
            if (inputGroups[1]) {
                inputGroups[1].querySelector('.question-input').value = '';
            }
            
            // „Åù„ÅÆ‰ªñ„ÅÆ„Éï„Ç£„Éº„É´„Éâ„Çí„ÇØ„É™„Ç¢
            document.getElementById('answer').value = '';
            document.getElementById('link').value = '';
        }

        function displayRecords() {
            const recordsList = document.getElementById('records-list');
            
            if (!currentCategory || !faqData[currentCategory]) {
                recordsList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìù</div>
                        <div class="empty-title">FAQ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                        <div class="empty-text">‰∏ä„ÅÆ„Éï„Ç©„Éº„É†„Åã„ÇâÊúÄÂàù„ÅÆFAQÈ†ÖÁõÆ„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                    </div>
                `;
                document.getElementById('record-count').textContent = '0‰ª∂';
                return;
            }
            
            const records = faqData[currentCategory];
            const count = records.length;
            
            document.getElementById('record-count').textContent = `${count}‰ª∂`;
            
            if (records.length === 0) {
                recordsList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìù</div>
                        <div class="empty-title">FAQ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                        <div class="empty-text">‰∏ä„ÅÆ„Éï„Ç©„Éº„É†„Åã„ÇâÊúÄÂàù„ÅÆFAQÈ†ÖÁõÆ„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                    </div>
                `;
                return;
            }
            
            recordsList.innerHTML = records.map(record => {
                // ÊóßÂΩ¢ÂºèÔºàÂçò‰∏ÄË≥™ÂïèÔºâ„Å®Êñ∞ÂΩ¢ÂºèÔºàË≥™Âïè„É™„Çπ„ÉàÔºâ„ÅÆ‰∏°Êñπ„Å´ÂØæÂøú
                const questionDisplay = record.questions ? 
                    `<strong>„É°„Ç§„É≥:</strong> ${record.questions[0]}${record.questions.length > 1 ? 
                        `<br><small style="color: #6b7280;">È°û‰ººË≥™Âïè: ${record.questions.slice(1).join(', ')}</small>` : ''}` :
                    record.question;
                
                return `
                    <div class="record-item" id="record-${record.id}">
                        <div class="record-field">
                            <div class="record-label">Ë≥™Âïè</div>
                            <div class="record-value">${questionDisplay}</div>
                        </div>
                        <div class="record-field">
                            <div class="record-label">ÂõûÁ≠î</div>
                            <div class="record-value">${record.answer}</div>
                        </div>
                        ${record.link ? `
                            <div class="record-field">
                                <div class="record-label">Èñ¢ÈÄ£„É™„É≥„ÇØ</div>
                                <div class="record-value"><a href="${record.link}" target="_blank">${record.link}</a></div>
                            </div>
                        ` : ''}
                        <div class="record-field">
                            <div class="record-label">ÁôªÈå≤Êó•</div>
                            <div class="record-value">${record.createdAt}</div>
                        </div>
                        <div class="record-actions">
                            <button class="btn btn-secondary" onclick="editRecord(${record.id})" style="padding: 6px 12px; font-size: 12px;">Á∑®ÈõÜ</button>
                            <button class="btn btn-danger" onclick="deleteRecord(${record.id})" style="padding: 6px 12px; font-size: 12px;">ÂâäÈô§</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function deleteRecord(id) {
            if (confirm('„Åì„ÅÆ„É¨„Ç≥„Éº„Éâ„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                faqData[currentCategory] = faqData[currentCategory].filter(record => record.id !== id);
                saveCategories();
                displayRecords();
                updateCategoryDisplay();
            }
        }

        function editRecord(id) {
            const record = faqData[currentCategory].find(r => r.id === id);
            if (!record) return;
            
            const recordElement = document.getElementById(`record-${id}`);
            editingId = id;
            
            // Ë≥™Âïè„É™„Çπ„Éà„ÅÆÁîüÊàêÔºàÊñ∞ÂΩ¢Âºè„ÉªÊóßÂΩ¢ÂºèÂØæÂøúÔºâ
            const questions = record.questions || [record.question || ''];
            const questionInputsHtml = questions.map((question, index) => {
                const isMain = index === 0;
                const label = isMain ? '„É°„Ç§„É≥' : `È°û‰ºº${index}`;
                const removeBtn = isMain ? '' : `<button type="button" class="remove-question-btn" onclick="removeEditQuestionInput(this)" title="ÂâäÈô§">√ó</button>`;
                
                return `
                    <div class="question-input-group">
                        <span class="question-label ${isMain ? 'main' : ''}">${label}</span>
                        <input type="text" class="question-input ${isMain ? 'main-question' : ''}" value="${question.replace(/"/g, '&quot;')}" ${isMain ? 'required' : ''}>
                        ${removeBtn}
                    </div>
                `;
            }).join('');
            
            recordElement.innerHTML = `
                <div style="background: #f8fafc; padding: 16px; border-radius: 8px; border: 2px solid #4f46e5;">
                    <div class="form-group">
                        <label class="form-label">Ë≥™Âïè„É™„Çπ„Éà</label>
                        <div class="question-list-container" id="edit-question-list-${id}">
                            ${questionInputsHtml}
                        </div>
                        <button type="button" class="add-question-btn" onclick="addEditQuestionInput(${id})">
                            + È°û‰ººË≥™Âïè„ÇíËøΩÂä†
                        </button>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÂõûÁ≠î</label>
                        <textarea id="edit-answer" class="form-textarea">${record.answer}</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Èñ¢ÈÄ£„É™„É≥„ÇØ</label>
                        <input type="url" id="edit-link" class="form-input" value="${record.link || ''}">
                    </div>
                    <div style="display: flex; gap: 8px; margin-top: 16px;">
                        <button class="btn btn-success" onclick="saveRecord(${id})" style="padding: 8px 16px; font-size: 12px;">‰øùÂ≠ò</button>
                        <button class="btn btn-secondary" onclick="cancelEdit()" style="padding: 8px 16px; font-size: 12px;">„Ç≠„É£„É≥„Çª„É´</button>
                    </div>
                </div>
            `;
        }

        function saveRecord(id) {
            // Ë≥™Âïè„É™„Çπ„Éà„ÇíÂèñÂæó
            const questionInputs = document.querySelectorAll(`#edit-question-list-${id} .question-input`);
            const questions = [];
            questionInputs.forEach(input => {
                const value = input.value.trim();
                if (value) {
                    questions.push(value);
                }
            });
            
            const answer = document.getElementById('edit-answer').value.trim();
            const link = document.getElementById('edit-link').value.trim();
            
            if (questions.length === 0 || !questions[0]) {
                alert('„É°„Ç§„É≥„ÅÆË≥™Âïè„ÅØÂøÖÈ†à„Åß„Åô');
                return;
            }
            
            if (!answer) {
                alert('ÂõûÁ≠î„ÅØÂøÖÈ†à„Åß„Åô');
                return;
            }
            
            const recordIndex = faqData[currentCategory].findIndex(r => r.id === id);
            if (recordIndex !== -1) {
                faqData[currentCategory][recordIndex] = {
                    ...faqData[currentCategory][recordIndex],
                    questions: questions,
                    mainQuestion: questions[0],
                    answer: answer,
                    link: link
                };
            }
            
            editingId = null;
            saveCategories();
            displayRecords();
        }

        function addEditQuestionInput(recordId) {
            const container = document.getElementById(`edit-question-list-${recordId}`);
            const questionCount = container.querySelectorAll('.question-input-group').length;
            
            const newInputGroup = document.createElement('div');
            newInputGroup.className = 'question-input-group';
            newInputGroup.innerHTML = `
                <span class="question-label">È°û‰ºº${questionCount}</span>
                <input type="text" class="question-input" placeholder="È°û‰ººË≥™Âïè„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà‰ªªÊÑèÔºâ">
                <button type="button" class="remove-question-btn" onclick="removeEditQuestionInput(this)" title="ÂâäÈô§">√ó</button>
            `;
            
            container.appendChild(newInputGroup);
        }

        function removeEditQuestionInput(button) {
            const inputGroup = button.parentElement;
            const container = inputGroup.parentElement;
            
            // „É°„Ç§„É≥Ë≥™Âïè‰ª•Â§ñ„ÅØÂâäÈô§ÂèØËÉΩ
            if (!inputGroup.querySelector('.main-question')) {
                container.removeChild(inputGroup);
                updateEditQuestionLabels(container);
            }
        }

        function updateEditQuestionLabels(container) {
            const inputGroups = container.querySelectorAll('.question-input-group');
            
            inputGroups.forEach((group, index) => {
                const label = group.querySelector('.question-label');
                if (index === 0) {
                    label.textContent = '„É°„Ç§„É≥';
                    label.className = 'question-label main';
                } else {
                    label.textContent = `È°û‰ºº${index}`;
                    label.className = 'question-label';
                }
            });
        }

        function cancelEdit() {
            editingId = null;
            displayRecords();
        }

        // CSVÈñ¢ÈÄ£
        function downloadCSV() {
            let csvContent = '„Ç´„ÉÜ„Ç¥„É™,Ë≥™Âïè,È°û‰ººË≥™Âïè,ÂõûÁ≠î,„É™„É≥„ÇØ,ÁôªÈå≤Êó•\n';
            
            Object.keys(categories).forEach(categoryKey => {
                if (faqData[categoryKey]) {
                    faqData[categoryKey].forEach(record => {
                        // Êñ∞ÂΩ¢ÂºèÔºàË≥™Âïè„É™„Çπ„ÉàÔºâ„Å®ÊóßÂΩ¢ÂºèÔºàÂçò‰∏ÄË≥™ÂïèÔºâ„ÅÆ‰∏°Êñπ„Å´ÂØæÂøú
                        let mainQuestion, similarQuestions;
                        
                        if (record.questions && record.questions.length > 0) {
                            // Êñ∞ÂΩ¢ÂºèÔºöË≥™Âïè„É™„Çπ„Éà
                            mainQuestion = record.questions[0];
                            similarQuestions = record.questions.slice(1).join(' | '); // È°û‰ººË≥™Âïè„Çí | „ÅßÂå∫Âàá„Çä
                        } else {
                            // ÊóßÂΩ¢ÂºèÔºöÂçò‰∏ÄË≥™Âïè
                            mainQuestion = record.question || '';
                            similarQuestions = '';
                        }
                        
                        const row = [
                            `"${record.category}"`,
                            `"${mainQuestion.replace(/"/g, '""')}"`,
                            `"${similarQuestions.replace(/"/g, '""')}"`,
                            `"${record.answer.replace(/"/g, '""')}"`,
                            `"${(record.link || '').replace(/"/g, '""')}"`,
                            `"${record.createdAt}"`
                        ].join(',');
                        csvContent += row + '\n';
                    });
                }
            });
            
            // BOM„ÇíËøΩÂä†„Åó„Å¶Excel„ÅßÊñáÂ≠óÂåñ„Åë„Åó„Å™„ÅÑ„Çà„ÅÜ„Å´„Åô„Çã
            const bom = '\uFEFF';
            const blob = new Blob([bom + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `faq_data_${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        // „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter' && event.ctrlKey) {
                if (editingId) {
                    saveRecord(editingId);
                } else {
                    addRecord();
                }
            }
            
            if (event.key === 'Enter' && event.target.id === 'new-category-name') {
                addCategory();
            }
        });

        // „Éï„Ç°„Ç§„É´„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂá¶ÁêÜ
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const fileName = file.name.toLowerCase();
            const fileExtension = fileName.split('.').pop();
            
            if (fileExtension === 'csv') {
                handleCSVUpload(file);
            } else if (fileExtension === 'xlsx' || fileExtension === 'xls') {
                handleExcelUpload(file);
            } else {
                showUploadStatus('„Çµ„Éù„Éº„Éà„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑ„Éï„Ç°„Ç§„É´ÂΩ¢Âºè„Åß„ÅôÔºàCSV, Excel „ÅÆ„ÅøÂØæÂøúÔºâ', 'error');
            }
        }

        function handleCSVUpload(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    parseCSVData(e.target.result);
                } catch (error) {
                    showUploadStatus('CSV„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message, 'error');
                }
            };
            reader.readAsText(file, 'UTF-8');
        }

        function handleExcelUpload(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const csvData = XLSX.utils.sheet_to_csv(worksheet);
                    parseCSVData(csvData);
                } catch (error) {
                    showUploadStatus('Excel„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + error.message, 'error');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function parseCSVData(csvText) {
            const lines = csvText.split('\n').filter(line => line.trim());
            if (lines.length < 2) {
                showUploadStatus('„Éï„Ç°„Ç§„É´„ÅåÁ©∫„Åã„ÄÅ„Éò„ÉÉ„ÉÄ„Éº„ÅÆ„Åø„Åß„Åô', 'error');
                return;
            }
            
            const headerLine = lines[0];
            const headers = parseCSVLine(headerLine).map(h => h.replace(/"/g, '').trim());
            
            // Êñ∞ÂΩ¢ÂºèÔºàÈ°û‰ººË≥™ÂïèÂàó„ÅÇ„ÇäÔºâ„Å®ÊóßÂΩ¢ÂºèÔºàÈ°û‰ººË≥™ÂïèÂàó„Å™„ÅóÔºâ„ÅÆ‰∏°Êñπ„Å´ÂØæÂøú
            const hasNewFormat = headers.includes('È°û‰ººË≥™Âïè');
            const requiredHeaders = hasNewFormat ? 
                ['„Ç´„ÉÜ„Ç¥„É™', 'Ë≥™Âïè', 'È°û‰ººË≥™Âïè', 'ÂõûÁ≠î', '„É™„É≥„ÇØ', 'ÁôªÈå≤Êó•'] :
                ['„Ç´„ÉÜ„Ç¥„É™', 'Ë≥™Âïè', 'ÂõûÁ≠î', '„É™„É≥„ÇØ', 'ÁôªÈå≤Êó•'];
            
            const headerValidation = validateHeaders(headers, requiredHeaders);
            
            if (!headerValidation.isValid) {
                showUploadStatus(
                    `„Éò„ÉÉ„ÉÄ„ÉºÂàó„ÅåÊ≠£„Åó„Åè„ÅÇ„Çä„Åæ„Åõ„ÇìÔºÅ\n` +
                    `ÂøÖÈ†à: ${requiredHeaders.join(', ')}\n` +
                    `ÂÆüÈöõ: ${headers.join(', ')}\n` +
                    `„Ç®„É©„ÉºË©≥Á¥∞: ${headerValidation.error}`, 
                    'error'
                );
                return;
            }
            
            const dataLines = lines.slice(1);
            let importedCount = 0;
            let errorCount = 0;
            let errorDetails = [];
            let newCategories = [];
            
            dataLines.forEach((line, index) => {
                try {
                    const columns = parseCSVLine(line);
                    if (columns.length < 3) {
                        errorCount++;
                        errorDetails.push(`Ë°å${index + 2}: „Éá„Éº„Çø„Åå‰∏çË∂≥„Åó„Å¶„ÅÑ„Åæ„Åô`);
                        return;
                    }
                    
                    let category, mainQuestion, similarQuestions, answer, link, createdAt;
                    
                    if (hasNewFormat) {
                        [category, mainQuestion, similarQuestions, answer, link, createdAt] = columns.map(col => 
                            col.replace(/^"|"$/g, '').trim()
                        );
                    } else {
                        [category, mainQuestion, answer, link, createdAt] = columns.map(col => 
                            col.replace(/^"|"$/g, '').trim()
                        );
                        similarQuestions = '';
                    }
                    
                    if (!category || !mainQuestion || !answer) {
                        errorCount++;
                        errorDetails.push(`Ë°å${index + 2}: „Ç´„ÉÜ„Ç¥„É™„ÄÅË≥™Âïè„ÄÅÂõûÁ≠î„ÅØÂøÖÈ†à„Åß„Åô`);
                        return;
                    }
                    
                    const categoryKey = category.toLowerCase().replace(/\s+/g, '_');
                    if (!categories[categoryKey]) {
                        categories[categoryKey] = category;
                        faqData[categoryKey] = [];
                        newCategories.push(category);
                    }
                    
                    // Ë≥™Âïè„É™„Çπ„Éà„Çí‰ΩúÊàê
                    const questions = [mainQuestion];
                    if (similarQuestions) {
                        const similarArray = similarQuestions.split('|').map(q => q.trim()).filter(q => q);
                        questions.push(...similarArray);
                    }
                    
                    const exists = faqData[categoryKey].some(record => {
                        const existingMain = record.questions ? record.questions[0] : record.question;
                        return existingMain && existingMain.trim() === mainQuestion.trim();
                    });
                    
                    if (!exists) {
                        const record = {
                            id: Date.now() + index + Math.random() * 1000,
                            category: category,
                            questions: questions,
                            mainQuestion: mainQuestion,
                            answer: answer,
                            link: link || '',
                            createdAt: createdAt || new Date().toLocaleString('ja-JP')
                        };
                        
                        faqData[categoryKey].push(record);
                        importedCount++;
                    } else {
                        errorDetails.push(`Ë°å${index + 2}: ÈáçË§á„Åô„ÇãË≥™Âïè„Äå${mainQuestion}„Äç`);
                    }
                } catch (error) {
                    errorCount++;
                    errorDetails.push(`Ë°å${index + 2}: Ëß£Êûê„Ç®„É©„Éº - ${error.message}`);
                }
            });
            
            saveCategories();
            updateCategoryDisplay();
            updateUIVisibility();
            
            if (currentCategory) {
                displayRecords();
            }
            
            let message = `${importedCount}‰ª∂„ÅÆ„Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà„Åó„Åæ„Åó„Åü`;
            if (newCategories.length > 0) {
                message += `\nÊñ∞Ë¶è„Ç´„ÉÜ„Ç¥„É™: ${newCategories.join(', ')}`;
            }
            if (errorCount > 0) {
                message += `\nÔºà${errorCount}‰ª∂„ÅÆ„Ç®„É©„Éº„Çí„Çπ„Ç≠„ÉÉ„ÉóÔºâ`;
                if (errorDetails.length > 0) {
                    message += `\n\n„Ç®„É©„ÉºË©≥Á¥∞:\n${errorDetails.slice(0, 5).join('\n')}`;
                    if (errorDetails.length > 5) {
                        message += `\n...‰ªñ${errorDetails.length - 5}‰ª∂`;
                    }
                }
            }
            showUploadStatus(message, importedCount > 0 ? 'success' : 'error');
            
            document.getElementById('csv-file').value = '';
        }

        function validateHeaders(actualHeaders, requiredHeaders) {
            const result = { isValid: true, error: '' };
            const missingHeaders = requiredHeaders.filter(required => 
                !actualHeaders.some(actual => actual === required)
            );
            
            if (missingHeaders.length > 0) {
                result.isValid = false;
                result.error = `‰∏çË∂≥„Åó„Å¶„ÅÑ„ÇãÂàó: ${missingHeaders.join(', ')}`;
                return result;
            }
            
            return result;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                const nextChar = line[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current.trim());
            return result;
        }

        function showUploadStatus(message, type) {
            const statusArea = document.getElementById('upload-status-area');
            statusArea.innerHTML = `
                <div class="upload-status upload-${type}">
                    ${message}
                </div>
            `;
            
            setTimeout(() => {
                statusArea.innerHTML = '';
            }, type === 'error' ? 5000 : 3000);
        }

        // „Éô„ÇØ„Éà„É´ÂåñÂá¶ÁêÜ
        function handleVectorFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!file.name.toLowerCase().endsWith('.csv')) {
                showVectorError('CSV„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            vectorCsvBlob = file;
            document.getElementById('vector-file-name').textContent = file.name;
            document.getElementById('vector-file-info').style.display = 'block';
            document.getElementById('vector-error').style.display = 'none';
        }

        async function processVectorization() {
            if (!vectorCsvBlob) {
                showVectorError('CSV„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            const loadingEl = document.getElementById('vector-loading');
            const successEl = document.getElementById('vector-success');
            const errorEl = document.getElementById('vector-error');
            
            loadingEl.classList.add('show');
            successEl.style.display = 'none';
            errorEl.style.display = 'none';
            
            try {
                const formData = new FormData();
                formData.append('file', vectorCsvBlob, vectorCsvBlob.name);
                
                const response = await fetch(PROCESS_API_URL, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || '„Éô„ÇØ„Éà„É´ÂåñÂá¶ÁêÜ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                }
                
                const result = await response.json();
                
                loadingEl.classList.remove('show');
                successEl.style.display = 'block';
                
                document.getElementById('vector-csv-file').value = '';
                document.getElementById('vector-file-info').style.display = 'none';
                vectorCsvBlob = null;
                
            } catch (error) {
                loadingEl.classList.remove('show');
                showVectorError(error.message);
            }
        }

        function showVectorError(message) {
            const errorEl = document.getElementById('vector-error');
            const errorMessageEl = document.getElementById('vector-error-message');
            
            errorMessageEl.textContent = message;
            errorEl.style.display = 'block';
        }

        // Ë≥™Âïè‰∏ÄË¶ßË°®Á§∫Ê©üËÉΩ
        function showQuestionList() {
            if (!currentCategory) {
                alert('„Ç´„ÉÜ„Ç¥„É™„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            const categoryName = categories[currentCategory];
            const records = faqData[currentCategory] || [];
            
            // „É¢„Éº„ÉÄ„É´„Çø„Ç§„Éà„É´„ÇíÊõ¥Êñ∞
            document.getElementById('modal-category-title').textContent = `„Äê${categoryName}„Äë„ÅÆË≥™Âïè‰∏ÄË¶ß`;
            
            const questionList = document.getElementById('modal-question-list');
            
            if (records.length === 0) {
                questionList.innerHTML = `
                    <div class="modal-empty">
                        <div class="modal-empty-icon">üìù</div>
                        <div class="empty-title">Ë≥™Âïè„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                        <div class="empty-text">„Åæ„Å†„Åì„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Å´„ÅØË≥™Âïè„ÅåÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</div>
                    </div>
                `;
            } else {
                questionList.innerHTML = records.map((record, index) => {
                    // ÊóßÂΩ¢Âºè„Å®Êñ∞ÂΩ¢Âºè„ÅÆ‰∏°Êñπ„Å´ÂØæÂøú
                    const mainQuestion = record.questions ? record.questions[0] : record.question;
                    const allQuestions = record.questions || [record.question];
                    
                    return `
                        <li class="question-item">
                            <div class="question-summary" onclick="toggleQuestionDetails(${index})">
                                <div class="question-text">${mainQuestion}</div>
                                <div class="question-meta">${record.createdAt}</div>
                            </div>
                            <div class="question-details" id="details-${index}">
                                ${allQuestions.length > 1 ? `
                                    <div class="detail-section">
                                        <div class="detail-label">ÂÖ®„Å¶„ÅÆË≥™Âïè</div>
                                        <div class="detail-value">
                                            ${allQuestions.map((q, i) => 
                                                `<strong>${i === 0 ? '„É°„Ç§„É≥' : 'È°û‰ºº' + i}:</strong> ${q}`
                                            ).join('<br>')}
                                        </div>
                                    </div>
                                ` : ''}
                                <div class="detail-section">
                                    <div class="detail-label">ÂõûÁ≠î</div>
                                    <div class="detail-value">${record.answer}</div>
                                </div>
                                ${record.link ? `
                                    <div class="detail-section">
                                        <div class="detail-label">Èñ¢ÈÄ£„É™„É≥„ÇØ</div>
                                        <div class="detail-value"><a href="${record.link}" target="_blank">${record.link}</a></div>
                                    </div>
                                ` : ''}
                                <div class="question-actions">
                                    <button class="modal-btn modal-btn-edit" onclick="startEditInModal(${record.id}, ${index})">‚úèÔ∏è Á∑®ÈõÜ</button>
                                    <button class="modal-btn modal-btn-delete" onclick="deleteFromModal(${record.id})">üóëÔ∏è ÂâäÈô§</button>
                                </div>
                                <div class="edit-form" id="edit-form-${index}" onclick="event.stopPropagation()">
                                    <div class="edit-form-group">
                                        <label class="edit-form-label">Ë≥™Âïè„É™„Çπ„Éà</label>
                                        <div class="question-list-container" id="modal-edit-question-list-${index}">
                                            ${allQuestions.map((question, qIndex) => {
                                                const isMain = qIndex === 0;
                                                const label = isMain ? '„É°„Ç§„É≥' : `È°û‰ºº${qIndex}`;
                                                const removeBtn = isMain ? '' : `<button type="button" class="remove-question-btn" onclick="removeModalQuestionInput(this)" title="ÂâäÈô§">√ó</button>`;
                                                
                                                return `
                                                    <div class="question-input-group">
                                                        <span class="question-label ${isMain ? 'main' : ''}">${label}</span>
                                                        <input type="text" class="question-input ${isMain ? 'main-question' : ''}" value="${question.replace(/"/g, '&quot;')}" ${isMain ? 'required' : ''}>
                                                        ${removeBtn}
                                                    </div>
                                                `;
                                            }).join('')}
                                        </div>
                                        <button type="button" class="add-question-btn" onclick="addModalQuestionInput(${index})" style="margin-top: 8px; font-size: 11px; padding: 4px 8px;">
                                            + È°û‰ººË≥™Âïè„ÇíËøΩÂä†
                                        </button>
                                    </div>
                                    <div class="edit-form-group">
                                        <label class="edit-form-label">ÂõûÁ≠î</label>
                                        <textarea class="edit-form-textarea" id="modal-edit-answer-${index}">${record.answer}</textarea>
                                    </div>
                                    <div class="edit-form-group">
                                        <label class="edit-form-label">Èñ¢ÈÄ£„É™„É≥„ÇØ</label>
                                        <input type="url" class="edit-form-input" id="modal-edit-link-${index}" value="${record.link || ''}">
                                    </div>
                                    <div class="edit-form-actions">
                                        <button class="modal-btn modal-btn-edit" onclick="saveEditInModal(${record.id}, ${index})">‰øùÂ≠ò</button>
                                        <button class="modal-btn" onclick="cancelEditInModal(${index})" style="background: #6b7280; color: white;">„Ç≠„É£„É≥„Çª„É´</button>
                                    </div>
                                </div>
                            </div>
                        </li>
                    `;
                }).join('');
            }
            
            // „É¢„Éº„ÉÄ„É´„ÇíË°®Á§∫
            document.getElementById('question-modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function hideQuestionList() {
            document.getElementById('question-modal').classList.remove('show');
            document.body.style.overflow = '';
            
            // ÂÖ®„Å¶„ÅÆË©≥Á¥∞„ÇíÈñâ„Åò„Çã
            document.querySelectorAll('.question-details').forEach(detail => {
                detail.classList.remove('show');
            });
        }

        function toggleQuestionDetails(index) {
            const details = document.getElementById(`details-${index}`);
            const editForm = document.getElementById(`edit-form-${index}`);
            
            // Á∑®ÈõÜ„Éï„Ç©„Éº„É†„ÅåÈñã„ÅÑ„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØÈñâ„Åò„Å™„ÅÑ
            if (editForm && editForm.classList.contains('show')) {
                return;
            }
            
            details.classList.toggle('show');
        }

        // „É¢„Éº„ÉÄ„É´Â§ñ„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('question-modal');
            if (event.target === modal) {
                hideQuestionList();
            }
        });

        // ESC„Ç≠„Éº„Åß„É¢„Éº„ÉÄ„É´„ÇíÈñâ„Åò„Çã
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                hideQuestionList();
            }
        });

        // „É¢„Éº„ÉÄ„É´ÂÜÖ„Åß„ÅÆÁ∑®ÈõÜÊ©üËÉΩ
        function startEditInModal(recordId, index) {
            const editForm = document.getElementById(`edit-form-${index}`);
            editForm.classList.add('show');
        }

        function cancelEditInModal(index) {
            const editForm = document.getElementById(`edit-form-${index}`);
            editForm.classList.remove('show');
            
            // ÂÖÉ„ÅÆÂÄ§„Å´Êàª„Åô
            const record = faqData[currentCategory].find(r => r.id === parseInt(document.getElementById(`modal-edit-question-${index}`).dataset.recordId));
            if (record) {
                document.getElementById(`modal-edit-question-${index}`).value = record.question;
                document.getElementById(`modal-edit-answer-${index}`).value = record.answer;
                document.getElementById(`modal-edit-link-${index}`).value = record.link || '';
            }
        }

        function saveEditInModal(recordId, index) {
            // Ë≥™Âïè„É™„Çπ„Éà„ÇíÂèñÂæó
            const questionInputs = document.querySelectorAll(`#modal-edit-question-list-${index} .question-input`);
            const questions = [];
            questionInputs.forEach(input => {
                const value = input.value.trim();
                if (value) {
                    questions.push(value);
                }
            });
            
            const answer = document.getElementById(`modal-edit-answer-${index}`).value.trim();
            const link = document.getElementById(`modal-edit-link-${index}`).value.trim();
            
            if (questions.length === 0 || !questions[0]) {
                alert('„É°„Ç§„É≥„ÅÆË≥™Âïè„ÅØÂøÖÈ†à„Åß„Åô');
                return;
            }
            
            if (!answer) {
                alert('ÂõûÁ≠î„ÅØÂøÖÈ†à„Åß„Åô');
                return;
            }
            
            // „Éá„Éº„Çø„ÇíÊõ¥Êñ∞
            const recordIndex = faqData[currentCategory].findIndex(r => r.id === recordId);
            if (recordIndex !== -1) {
                faqData[currentCategory][recordIndex] = {
                    ...faqData[currentCategory][recordIndex],
                    questions: questions,
                    mainQuestion: questions[0],
                    answer: answer,
                    link: link
                };
            }
            
            saveCategories();
            
            // Á∑®ÈõÜ„Éï„Ç©„Éº„É†„ÇíÈñâ„Åò„Çã
            document.getElementById(`edit-form-${index}`).classList.remove('show');
            
            // „É¢„Éº„ÉÄ„É´„ÅÆË°®Á§∫„ÇíÊõ¥Êñ∞
            showQuestionList();
            
            // „É°„Ç§„É≥ÁîªÈù¢„ÅÆ„É¨„Ç≥„Éº„Éâ‰∏ÄË¶ß„ÇÇÊõ¥Êñ∞
            displayRecords();
            
            alert('Êõ¥Êñ∞„Åó„Åæ„Åó„ÅüÔºÅ');
        }

        function addModalQuestionInput(index) {
            const container = document.getElementById(`modal-edit-question-list-${index}`);
            const questionCount = container.querySelectorAll('.question-input-group').length;
            
            const newInputGroup = document.createElement('div');
            newInputGroup.className = 'question-input-group';
            newInputGroup.innerHTML = `
                <span class="question-label">È°û‰ºº${questionCount}</span>
                <input type="text" class="question-input" placeholder="È°û‰ººË≥™Âïè„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà‰ªªÊÑèÔºâ">
                <button type="button" class="remove-question-btn" onclick="removeModalQuestionInput(this)" title="ÂâäÈô§">√ó</button>
            `;
            
            container.appendChild(newInputGroup);
        }

        function removeModalQuestionInput(button) {
            const inputGroup = button.parentElement;
            const container = inputGroup.parentElement;
            
            // „É°„Ç§„É≥Ë≥™Âïè‰ª•Â§ñ„ÅØÂâäÈô§ÂèØËÉΩ
            if (!inputGroup.querySelector('.main-question')) {
                container.removeChild(inputGroup);
                updateModalQuestionLabels(container);
            }
        }

        function updateModalQuestionLabels(container) {
            const inputGroups = container.querySelectorAll('.question-input-group');
            
            inputGroups.forEach((group, index) => {
                const label = group.querySelector('.question-label');
                if (index === 0) {
                    label.textContent = '„É°„Ç§„É≥';
                    label.className = 'question-label main';
                } else {
                    label.textContent = `È°û‰ºº${index}`;
                    label.className = 'question-label';
                }
            });
        }

        function deleteFromModal(recordId) {
            if (!confirm('„Åì„ÅÆË≥™Âïè„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                return;
            }
            
            // „Éá„Éº„Çø„Åã„ÇâÂâäÈô§
            faqData[currentCategory] = faqData[currentCategory].filter(record => record.id !== recordId);
            saveCategories();
            updateCategoryDisplay();
            
            // „É¢„Éº„ÉÄ„É´„ÅÆË°®Á§∫„ÇíÊõ¥Êñ∞
            showQuestionList();
            
            // „É°„Ç§„É≥ÁîªÈù¢„ÅÆ„É¨„Ç≥„Éº„Éâ‰∏ÄË¶ß„ÇÇÊõ¥Êñ∞
            displayRecords();
            
            alert('ÂâäÈô§„Åó„Åæ„Åó„ÅüÔºÅ');
        }
    </script>
</body>
</html>
